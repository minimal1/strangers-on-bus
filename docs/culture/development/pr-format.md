# PR(Pull Request) 형식 가이드

## 개요

Pull Request(PR)는 코드 변경 사항을 중앙 저장소에 병합하기 전에 검토하는 메커니즘입니다. Strangers on Bus 프로젝트에서는 표준화된 PR 형식을 통해 리뷰 과정을 효율화하고, 코드 품질을 높이며, 프로젝트 히스토리를 명확하게 관리합니다.

## PR 제목 형식

PR 제목은 Conventional Commit 형식을 따릅니다:

```
<type>(<scope>): <short description>
```

예시:
- `feat(auth): 소셜 로그인 기능 구현`
- `fix(ui): 모바일 네비게이션 버그 수정`
- `docs(api): API 문서 업데이트`

## PR 설명 템플릿

모든 PR은 다음 템플릿을 사용하여 작성합니다:

```markdown
## 변경 사항 설명
<!-- 이 PR에서 무엇을 변경했는지 명확하게 설명해주세요 -->

## 관련 이슈
<!-- 관련된 이슈 번호를 적어주세요. 예: "Fixes #123", "Resolves #456" -->

## 테스트 방법
<!-- 변경 사항을 검증하기 위한 테스트 방법을 설명해주세요 -->

## 스크린샷 (UI 변경 시)
<!-- UI 변경이 있는 경우 Before/After 스크린샷을 첨부해주세요 -->

## 체크리스트
- [ ] 코드 스타일 가이드를 준수했습니다
- [ ] 변경 사항에 대한 테스트를 추가/수정했습니다
- [ ] 필요한 문서를 업데이트했습니다
- [ ] 변경 사항이 성능에 부정적인 영향을 미치지 않습니다
- [ ] 코드를 스스로 리뷰했습니다

## 추가 정보
<!-- 리뷰어가 알아야 할 추가 정보가 있다면 여기에 적어주세요 -->
```

## PR 작성 가이드라인

### 변경 사항 설명

변경 사항에 대한 명확하고 간결한 설명을 제공합니다. 다음 내용을 포함하세요:

1. **왜** 이 변경이 필요한가? (문제 상황)
2. **무엇을** 변경했는가? (해결책)
3. **어떤 영향**이 있는가? (부작용, 성능 변화 등)

예시:
```
## 변경 사항 설명
사용자가 모바일 장치에서 네비게이션 메뉴를 열 때 일부 메뉴 항목이 화면 밖으로 벗어나는 문제가 있었습니다. 이를 해결하기 위해 모바일 환경에서 메뉴의 스타일을 수정하고, 오버플로우 처리를 추가했습니다. 이 변경으로 모든 화면 크기에서 메뉴가 정상적으로 표시됩니다.
```

### 관련 이슈

PR과 관련된 GitHub 이슈를 참조합니다. 이슈 참조에 사용할 수 있는 키워드:

- `Fixes #123` - PR이 병합되면 이슈 #123이 자동으로 닫힙니다
- `Resolves #456` - PR이 병합되면 이슈 #456이 자동으로 닫힙니다
- `Relates to #789` - PR이 이슈 #789와 관련이 있지만, 완전히 해결하지는 않습니다

### 테스트 방법

변경 사항을 검증하기 위한 구체적인 단계를 제공합니다. 가능한 한 자세히 설명하여 리뷰어가 쉽게 따라할 수 있도록 합니다.

예시:
```
## 테스트 방법
1. 애플리케이션을 모바일 화면 크기(375px 너비)로 실행
2. 오른쪽 상단의 햄버거 메뉴 아이콘 클릭
3. 메뉴가 열리면 모든 항목이 화면 내에 표시되는지 확인
4. 다양한 모바일 화면 크기(320px, 375px, 414px, 768px)에서 테스트하여 메뉴가 올바르게 표시되는지 확인
5. 가로 모드에서도 테스트하여 레이아웃이 깨지지 않는지 확인
```

### 스크린샷

UI 변경이 있는 경우, 변경 전후 스크린샷을 제공합니다. 이는 리뷰어가 변경 사항을 시각적으로 이해하는 데 도움이 됩니다.

- 변경 전/후 스크린샷을 나란히 배치하여 비교할 수 있게 합니다.
- 다양한 화면 크기에서의 스크린샷을 제공하면 더 유용합니다.
- 애니메이션이나 상호작용이 있는 경우 GIF나 짧은 비디오를 첨부할 수 있습니다.

## PR 리뷰 프로세스

### 리뷰어 지정

- PR 작성자는 최소 1명 이상의 리뷰어를 지정해야 합니다.
- 코드 오너십에 따라 해당 영역의 전문가를 리뷰어로 지정합니다.
- 가능하면 다양한 역할(프론트엔드, 백엔드, DevOps 등)의 리뷰어를 포함합니다.

### 리뷰 기준

리뷰어는 다음 기준으로 PR을 평가합니다:

1. **기능성**: 변경 사항이 의도한 대로 작동하는가?
2. **코드 품질**: 코드가 가독성이 좋고 유지보수 가능한가?
3. **테스트 적절성**: 테스트가 충분하고 적절한가?
4. **성능 영향**: 변경 사항이 성능에 미치는 영향은 어떠한가?
5. **보안 영향**: 보안 측면에서 문제는 없는가?
6. **문서화**: 필요한 문서가 업데이트되었는가?

### 리뷰 의견 제공

- 구체적이고 건설적인 의견을 제공합니다.
- 단순히 문제를 지적하기보다는 해결책이나 개선 방향을 제시합니다.
- 코드 자체보다 사람을 비판하지 않습니다.
- 긍정적인 부분도 언급하여 균형 잡힌 피드백을 제공합니다.

예시:
```
이 부분에서 잠재적인 성능 이슈가 있을 수 있습니다. 배열이 매우 커질 경우 O(n²) 복잡도가 될 수 있어요.
다음과 같이 Map을 사용하면 O(n) 복잡도로 개선할 수 있습니다:

```javascript
const itemMap = new Map();
items.forEach(item => itemMap.set(item.id, item));
```
```

### PR 변경 요청 및 승인

- 중요한 문제가 있는 경우 "변경 요청(Request changes)"을 사용합니다.
- 사소한 문제만 있는 경우 "승인(Approve)"하고 코멘트로 개선점을 제안합니다.
- 모든 리뷰어의 승인이 있어야 병합할 수 있습니다.

## PR 병합 정책

### 병합 조건

PR을 병합하기 위한 필수 조건:

1. 모든 지정된 리뷰어로부터 승인 받기
2. CI 파이프라인의 모든 검사 통과
3. 모든 코드 품질 검사 통과 (ESLint, Prettier 등)
4. 브랜치가 최신 `main` 브랜치와 동기화되어 있음

### 병합 방법

Trunk Based Development 원칙에 따라:

1. **Squash and Merge**를 기본 방법으로 사용합니다.
   - 여러 커밋을 하나로 압축하여 `main` 브랜치의 히스토리를 깔끔하게 유지합니다.
   - 병합 커밋 메시지는 PR 제목과 설명을 기반으로 자동 생성됩니다.

2. 예외적으로 **Rebase and Merge**를 사용할 수 있습니다.
   - 각 커밋이 독립적인 의미를 가지고 있는 경우
   - 커밋 히스토리를 보존해야 하는 경우

### 병합 후 정리

- 병합 후에는 관련 브랜치를 삭제합니다.
- 연관된 이슈가 자동으로 닫히지 않은 경우 수동으로 이슈를 닫습니다.
- 필요한 경우 배포 파이프라인을 트리거합니다.

## 자동화 및 도구

### GitHub PR 템플릿

`.github/PULL_REQUEST_TEMPLATE.md` 파일에 PR 템플릿을 정의합니다.

### GitHub Actions 워크플로우

```yaml
# .github/workflows/pr-checks.yml
name: PR Checks

on:
  pull_request:
    branches: [ main ]

jobs:
  validate-pr:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Validate PR title
        uses: amannn/action-semantic-pull-request@v5
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          types: ['feat', 'fix', 'docs', 'style', 'refactor', 'perf', 'test', 'build', 'ci', 'chore', 'revert']
          
      - name: Check PR body
        run: |
          if ! grep -q "## 변경 사항 설명" .github/PULL_REQUEST_TEMPLATE.md; then
            echo "PR body missing required sections"
            exit 1
          fi
```

## 참고 자료

- [GitHub 공식 PR 문서](https://docs.github.com/en/github/collaborating-with-pull-requests)
- [Conventional Commits](https://www.conventionalcommits.org/)
- [��과적인 코드 리뷰 방법](https://google.github.io/eng-practices/review/)
- [Trunk Based Development](https://trunkbaseddevelopment.com/)